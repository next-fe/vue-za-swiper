(function(m,y){typeof exports=="object"&&typeof module!="undefined"?module.exports=y():typeof define=="function"&&define.amd?define(y):(m=typeof globalThis!="undefined"?globalThis:m||self,m.index=y())})(this,function(){"use strict";var m=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},y="Expected a function",R=0/0,E="[object Symbol]",$=/^\s+|\s+$/g,B=/^[-+]0x[0-9a-f]+$/i,M=/^0b[01]+$/i,P=/^0o[0-7]+$/i,W=parseInt,H=typeof m=="object"&&m&&m.Object===Object&&m,G=typeof self=="object"&&self&&self.Object===Object&&self,z=H||G||Function("return this")(),F=Object.prototype,j=F.toString,U=Math.max,k=Math.min,w=function(){return z.Date.now()};function Z(t,e,i){var n,s,l,u,a,r,h=0,I=!1,p=!1,d=!0;if(typeof t!="function")throw new TypeError(y);e=L(e)||0,_(i)&&(I=!!i.leading,p="maxWait"in i,l=p?U(L(i.maxWait)||0,e):l,d="trailing"in i?!!i.trailing:d);function v(o){var g=n,T=s;return n=s=void 0,h=o,u=t.apply(T,g),u}function O(o){return h=o,a=setTimeout(C,e),I?v(o):u}function at(o){var g=o-r,T=o-h,x=e-g;return p?k(x,l-T):x}function A(o){var g=o-r,T=o-h;return r===void 0||g>=e||g<0||p&&T>=l}function C(){var o=w();if(A(o))return V(o);a=setTimeout(C,at(o))}function V(o){return a=void 0,d&&n?v(o):(n=s=void 0,u)}function ot(){a!==void 0&&clearTimeout(a),h=0,n=r=s=a=void 0}function lt(){return a===void 0?u:V(w())}function S(){var o=w(),g=A(o);if(n=arguments,s=this,r=o,g){if(a===void 0)return O(r);if(p)return a=setTimeout(C,e),v(r)}return a===void 0&&(a=setTimeout(C,e)),u}return S.cancel=ot,S.flush=lt,S}function X(t,e,i){var n=!0,s=!0;if(typeof t!="function")throw new TypeError(y);return _(i)&&(n="leading"in i?!!i.leading:n,s="trailing"in i?!!i.trailing:s),Z(t,e,{leading:n,maxWait:e,trailing:s})}function _(t){var e=typeof t;return!!t&&(e=="object"||e=="function")}function q(t){return!!t&&typeof t=="object"}function Y(t){return typeof t=="symbol"||q(t)&&j.call(t)==E}function L(t){if(typeof t=="number")return t;if(Y(t))return R;if(_(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=_(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=t.replace($,"");var i=M.test(t);return i||P.test(t)?W(t.slice(2),i?2:8):B.test(t)?R:+t}var J=X;function K(t){return typeof t=="number"&&!isNaN(t)}var b={isNumber:K,throttle:J},f={getCssValue(t){const e=String(t).match(/[+-]?(0|([1-9]\d*))(\.\d+)?/);return Number(e[0])},getCssUnit(t){return String(t).match(/([a-z]+)/)[1]},getDomPropertyValue(t,e){return Number(window.getComputedStyle(t).getPropertyValue(e).replace("px",""))}},Q=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{class:t.containerClasses},[t.useLeft?i("div",{staticClass:"za-swiper__btn",style:t.customBtnStyle,on:{click:t.slidePrev}},[t._t("left")],2):t._e(),i("div",{ref:"swiperBody",staticClass:"za-swiper__list-wrapper",on:{touchstart:t.touchstart,touchmove:t.touchmove,touchend:t.touchend,touchcancel:t.touchcancel}},[i("div",{ref:"swiperWrapper",staticClass:"za-swiper__list",style:{width:t.computedInnerWidth,height:t.computedInnerHeight,transform:"translate(0px, 0px)"}},t._l(t.doubleList,function(n,s){return i("div",{key:s,ref:"swiperItems",refInFor:!0,staticClass:"za-swiper__item",style:t.swiperItemStyle,attrs:{"data-index":s}},[t._t("default",null,{item:n,index:s})],2)}),0)]),t.useRight?i("div",{staticClass:"za-swiper__btn",style:t.customBtnStyle,on:{click:t.slideNext}},[t._t("right")],2):t._e()])},tt=[],ht="";function et(t,e,i,n,s,l,u,a){var r=typeof t=="function"?t.options:t;e&&(r.render=e,r.staticRenderFns=i,r._compiled=!0),n&&(r.functional=!0),l&&(r._scopeId="data-v-"+l);var h;if(u?(h=function(d){d=d||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,!d&&typeof __VUE_SSR_CONTEXT__!="undefined"&&(d=__VUE_SSR_CONTEXT__),s&&s.call(this,d),d&&d._registeredComponents&&d._registeredComponents.add(u)},r._ssrRegister=h):s&&(h=a?function(){s.call(this,(r.functional?this.parent:this).$root.$options.shadowRoot)}:s),h)if(r.functional){r._injectStyles=h;var I=r.render;r.render=function(v,O){return h.call(O),I(v,O)}}else{var p=r.beforeCreate;r.beforeCreate=p?[].concat(p,h):[h]}return{exports:t,options:r}}const D={COMPUTED:"computed",CUSTOM:"custom"},c={VERTICAL:"vertical",HORIZONTAL:"horizontal"},it={name:"za-swiper",props:{direction:{type:String,default:c.HORIZONTAL},itemSizeMode:{type:String,default:D.COMPUTED},list:{type:Array,required:!0},initialOffset:{type:[Number,String],default:0},visibleLength:{type:Number},innerHeight:{type:[Number,String],required:!0},innerWidth:{type:[Number,String],required:!0},spanGap:{type:[Number,String],default:0},sideGap:{type:[Number,String],default:0},autoPlay:{type:Boolean,default:!1},step:{type:Number,default:-.5},playDelay:{type:Number,default:2e3},playImmediate:{type:Boolean,default:!1},slideAnimationDuration:{type:Number,default:300}},data(){return{listDiv:0,leftBorder:0,rightBorder:0,itemWidth:"auto",itemHeight:"auto",itemFullDirectionLengthValue:0,lastOffset:0,intersectionRatioThreshold:.95,replayTimer:null,animationInterval:null,doubleList:[],playing:!1}},computed:{computedInnerWidth(){return b.isNumber(this.innerWidth)?`${this.innerWidth}px`:this.innerWidth},computedInnerHeight(){return b.isNumber(this.innerHeight)?`${this.innerHeight}px`:this.innerHeight},computedSpanGap(){return b.isNumber(this.spanGap)?`${this.spanGap}px`:this.spanGap},computedSideGap(){return b.isNumber(this.sideGap)?`${this.sideGap}px`:this.sideGap},customBtnStyle(){return{padding:`0 ${this.computedSideGap}`}},containerClasses(){const t=["za-swiper"];return this.direction===c.VERTICAL&&t.push("za-swiper--vertical"),t},swiperItemStyle(){const t={width:this.itemWidth,height:this.itemHeight,marginRight:0,marginBottom:0};return this.direction===c.HORIZONTAL?t.marginRight=this.computedSpanGap:t.marginBottom=this.computedSpanGap,t},useLeft(){return this.$slots.left},useRight(){return this.$slots.right}},methods:{getObserveEntries(){return new Promise(t=>{const e=new IntersectionObserver(i=>{e.disconnect(),t(i)},{root:this.$refs.swiperBody});this.$refs.swiperItems.forEach(i=>{e.observe(i)})})},getDomDirectionTranslate(){const[,t,e]=/translate\(([^p]+)px, ([^p]+)px\)/.exec(this.$refs.swiperWrapper.style.transform);return Number(this.direction===c.HORIZONTAL?t:e)},setDomDirectionTranslate(t){let e=0,i=0;this.direction===c.HORIZONTAL?e=t:i=t,this.$refs.swiperWrapper.style.transform=`translate(${e}px, ${i}px)`},initDoubleList(){const t=Math.floor(this.list.length/2);this.doubleList=[...this.list.slice(t),...this.list,...this.list.slice(0,t)],this.listDiv=this.list.length-t},initItemCss(){const t=f.getCssUnit(this.computedInnerWidth),e=f.getCssUnit(this.computedSpanGap);if(t!==e)throw new Error("Please unite spanGap\u3001innerWidth css unit");const i=this.direction===c.HORIZONTAL?this.computedInnerWidth:this.computedInnerHeight,n=f.getCssValue(i),s=f.getCssValue(this.computedSpanGap),l=(n-s*(this.visibleLength-1))/this.visibleLength;this.direction===c.HORIZONTAL?(this.itemWidth=l+t,this.itemHeight="100%"):(this.itemWidth="100%",this.itemHeight=l+t)},initItemRenderedValue(){const t=this.$refs.swiperItems[0];let e="width",i="margin-right";this.direction===c.VERTICAL&&(e="height",i="margin-bottom"),this.itemFullDirectionLengthValue=f.getDomPropertyValue(t,e)+f.getDomPropertyValue(t,i)},initTranslate(){const t=this.getDomDirectionTranslate()-this.itemFullDirectionLengthValue*this.listDiv;return this.setDomDirectionTranslate(t),Math.abs(t)},play(){this.translate=this.getDomDirectionTranslate();const t=()=>{this.setMove(this.step),this.animationInterval=requestAnimationFrame(t)};this.animationInterval=requestAnimationFrame(t)},replay(){clearTimeout(this.replayTimer),this.replayTimer=setTimeout(()=>{this.playing||this.play()},this.playDelay)},setMove(t){this.translate+=t;const e=Math.abs(this.translate);e>=this.rightBorder?this.translate=-(this.leftBorder+(e-this.rightBorder)):e<=this.leftBorder&&(this.translate=-(this.rightBorder-(this.leftBorder-e))),this.setDomDirectionTranslate(this.translate)},_slidePrev(){this.getObserveEntries().then(t=>{const e=t.findLastIndex(a=>a.intersectionRatio>=this.intersectionRatioThreshold),n=t.filter(a=>a.intersectionRatio>=this.intersectionRatioThreshold).length===this.visibleLength?e-1:e,s=t[n],l=s.rootBounds.right-s.boundingClientRect.right;this.translate+=l,this.setDomDirectionTranslate(this.translate);const u=Math.abs(this.translate);setTimeout(()=>{u<=this.leftBorder&&(this.translate=-(this.itemFullDirectionLengthValue*(n-this.visibleLength+1+this.list.length)),this.setDomDirectionTranslate(this.translate))},this.slideAnimationDuration)})},_slideNext(){this.getObserveEntries().then(t=>{const e=t.findIndex(a=>a.intersectionRatio>=this.intersectionRatioThreshold),n=t.filter(a=>a.intersectionRatio>=this.intersectionRatioThreshold).length===this.visibleLength?e+1:e,s=t[n],l=s.boundingClientRect.left-s.rootBounds.left;this.translate-=l,this.setDomDirectionTranslate(this.translate);const u=Math.abs(this.translate);setTimeout(()=>{u>=this.rightBorder&&(this.translate=-(this.itemFullDirectionLengthValue*(n-this.list.length)),this.setDomDirectionTranslate(this.translate))},this.slideAnimationDuration)})},initOffset(){let t=0;if(b.isNumber(this.initialOffset))t=this.initialOffset;else if(f.getCssUnit(this.initialOffset)==="px")t=f.getCssValue(this.initialOffset);else{const i=document.createElement("div");i.setAttribute("style",`width: ${this.initialOffset}; position: fixed; top: 9999px`),document.body.appendChild(i),t=f.getDomPropertyValue(i,"width"),document.body.removeChild(i)}this.translate=this.getDomDirectionTranslate(),this.setMove(t)},slidePrev(){if(this.direction===c.VERTICAL||this.itemSizeMode!==D.COMPUTED)throw new Error("\u4EC5\u5F53 direction \u4E3A horizontal \u4E14 item-width-mode \u4E3A computed \u65F6\u624D\u80FD\u4F7F\u7528\u6309\u94AE\u6ED1\u52A8\u529F\u80FD");this.handleSlide(!0)},slideNext(){if(this.direction===c.VERTICAL||this.itemSizeMode!==D.COMPUTED)throw new Error("\u4EC5\u5F53 direction \u4E3A horizontal \u4E14 item-width-mode \u4E3A computed \u65F6\u624D\u80FD\u4F7F\u7528\u6309\u94AE\u6ED1\u52A8\u529F\u80FD");this.handleSlide()},touchstart(t){this.playing=!0,cancelAnimationFrame(this.animationInterval),this.lastOffset=this.direction===c.HORIZONTAL?t.targetTouches[0].pageX:t.targetTouches[0].pageY,this.translate=this.getDomDirectionTranslate()},touchmove(t){const e=this.direction===c.HORIZONTAL?t.targetTouches[0].pageX:t.targetTouches[0].pageY,i=e-this.lastOffset;this.lastOffset=e,this.setMove(i)},touchend(){this.playing=!1,this.autoPlay&&this.replay()},touchcancel(){this.touchend()}},created(){if(this.itemSizeMode===D.COMPUTED){if(!this.visibleLength)throw new Error("visibleLength \u5FC5\u987B\u4E3A\u5927\u4E8E 0 \u7684\u6574\u6570");this.initItemCss()}this.initDoubleList()},mounted(){this.initItemRenderedValue();const t=this.initTranslate();if(this.leftBorder=t,this.rightBorder=this.itemFullDirectionLengthValue*this.list.length+t,this.initialOffset&&this.initOffset(),this.autoPlay){if(this.playImmediate){this.play();return}this.replay()}this.handleSlide=b.throttle(e=>{cancelAnimationFrame(this.animationInterval),Object.assign(this.$refs.swiperWrapper.style,{"transition-duration":`${this.slideAnimationDuration}ms`}),this.translate=this.getDomDirectionTranslate(),e?this._slidePrev():this._slideNext(),setTimeout(()=>{Object.assign(this.$refs.swiperWrapper.style,{"transition-duration":"0ms"}),this.autoPlay&&this.replay()},this.slideAnimationDuration)},this.slideAnimationDuration+200,{trailing:!1})},beforeDestroy(){clearTimeout(this.replayTimer),cancelAnimationFrame(this.animationInterval)}},N={};var st=et(it,Q,tt,!1,nt,"59aca861",null,null);function nt(t){for(let e in N)this[e]=N[e]}var rt=function(){return st.exports}();return rt});
