(function(c,g){typeof exports=="object"&&typeof module!="undefined"?module.exports=g():typeof define=="function"&&define.amd?define(g):(c=typeof globalThis!="undefined"?globalThis:c||self,c.index=g())})(this,function(){"use strict";var c=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},g="Expected a function",I=0/0,$="[object Symbol]",R=/^\s+|\s+$/g,E=/^[-+]0x[0-9a-f]+$/i,M=/^0b[01]+$/i,A=/^0o[0-7]+$/i,B=parseInt,P=typeof c=="object"&&c&&c.Object===Object&&c,L=typeof self=="object"&&self&&self.Object===Object&&self,G=P||L||Function("return this")(),F=Object.prototype,j=F.toString,U=Math.max,k=Math.min,C=function(){return G.Date.now()};function z(t,e,i){var n,s,d,h,a,r,l=0,X=!1,m=!1,u=!0;if(typeof t!="function")throw new TypeError(g);e=S(e)||0,_(i)&&(X=!!i.leading,m="maxWait"in i,d=m?U(S(i.maxWait)||0,e):d,u="trailing"in i?!!i.trailing:u);function b(o){var p=n,v=s;return n=s=void 0,l=o,h=t.apply(v,p),h}function W(o){return l=o,a=setTimeout(w,e),X?b(o):h}function rt(o){var p=o-r,v=o-l,N=e-p;return m?k(N,d-v):N}function O(o){var p=o-r,v=o-l;return r===void 0||p>=e||p<0||m&&v>=d}function w(){var o=C();if(O(o))return V(o);a=setTimeout(w,rt(o))}function V(o){return a=void 0,u&&n?b(o):(n=s=void 0,h)}function at(){a!==void 0&&clearTimeout(a),l=0,n=r=s=a=void 0}function ot(){return a===void 0?h:V(C())}function D(){var o=C(),p=O(o);if(n=arguments,s=this,r=o,p){if(a===void 0)return W(r);if(m)return a=setTimeout(w,e),b(r)}return a===void 0&&(a=setTimeout(w,e)),h}return D.cancel=at,D.flush=ot,D}function H(t,e,i){var n=!0,s=!0;if(typeof t!="function")throw new TypeError(g);return _(i)&&(n="leading"in i?!!i.leading:n,s="trailing"in i?!!i.trailing:s),z(t,e,{leading:n,maxWait:e,trailing:s})}function _(t){var e=typeof t;return!!t&&(e=="object"||e=="function")}function q(t){return!!t&&typeof t=="object"}function Z(t){return typeof t=="symbol"||q(t)&&j.call(t)==$}function S(t){if(typeof t=="number")return t;if(Z(t))return I;if(_(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=_(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=t.replace(R,"");var i=M.test(t);return i||A.test(t)?B(t.slice(2),i?2:8):E.test(t)?I:+t}var J=H;function K(t){return typeof t=="number"&&!isNaN(t)}var y={isNumber:K,throttle:J},f={getCssValue(t){const e=String(t).match(/[+-]?(0|([1-9]\d*))(\.\d+)?/);return Number(e[0])},getCssUnit(t){return String(t).match(/([a-z]+)/)[1]},getDomPropertyValue(t,e){return Number(window.getComputedStyle(t).getPropertyValue(e).replace("px",""))}},Q=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"za-swiper"},[t.useLeft?i("div",{staticClass:"za-swiper__btn",style:t.customBtnStyle,on:{click:t.slidePrev}},[t._t("left")],2):t._e(),i("div",{ref:"swiperBody",staticClass:"za-swiper__list-wrapper",on:{touchstart:t.touchstart,touchmove:t.touchmove,touchend:t.touchend,touchcancel:t.touchcancel}},[i("div",{ref:"swiperWrapper",staticClass:"za-swiper__list",style:{width:t.computedInnerWidth,height:t.computedInnerHeight,transform:"translateX(0px)"}},t._l(t.doubleList,function(n,s){return i("div",{key:s,ref:"swiperItems",refInFor:!0,staticClass:"za-swiper__item",style:{marginRight:t.computedSpanGap,width:t.itemWidth,height:"100%"},attrs:{"data-index":s}},[t._t("default",null,{item:n,index:s})],2)}),0)]),t.useRight?i("div",{staticClass:"za-swiper__btn",style:t.customBtnStyle,on:{click:t.slideNext}},[t._t("right")],2):t._e()])},Y=[],lt="";function tt(t,e,i,n,s,d,h,a){var r=typeof t=="function"?t.options:t;e&&(r.render=e,r.staticRenderFns=i,r._compiled=!0),n&&(r.functional=!0),d&&(r._scopeId="data-v-"+d);var l;if(h?(l=function(u){u=u||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,!u&&typeof __VUE_SSR_CONTEXT__!="undefined"&&(u=__VUE_SSR_CONTEXT__),s&&s.call(this,u),u&&u._registeredComponents&&u._registeredComponents.add(h)},r._ssrRegister=l):s&&(l=a?function(){s.call(this,(r.functional?this.parent:this).$root.$options.shadowRoot)}:s),l)if(r.functional){r._injectStyles=l;var X=r.render;r.render=function(b,W){return l.call(W),X(b,W)}}else{var m=r.beforeCreate;r.beforeCreate=m?[].concat(m,l):[l]}return{exports:t,options:r}}const T={COMPUTED:"computed",CUSTOM:"custom"},et={name:"za-swiper",props:{itemWidthMode:{type:String,default:T.COMPUTED},list:{type:Array,required:!0},initialOffset:{type:[Number,String],default:0},visibleLength:{type:Number},innerHeight:{type:[Number,String],required:!0},innerWidth:{type:[Number,String],required:!0},spanGap:{type:[Number,String],default:0},sideGap:{type:[Number,String],default:0},autoPlay:{type:Boolean,default:!1},step:{type:Number,default:-.5},playDelay:{type:Number,default:2e3},playImmediate:{type:Boolean,default:!1},slideAnimationDuration:{type:Number,default:300}},data(){return{listDiv:0,leftBorder:0,rightBorder:0,itemWidth:"auto",itemWidthValue:0,itemFullWidthValue:0,lastX:0,intersectionRatioThreshold:.95,replayTimer:null,animationInterval:null,doubleList:[],playing:!1}},computed:{computedInnerWidth(){return y.isNumber(this.innerWidth)?`${this.innerWidth}px`:this.innerWidth},computedInnerHeight(){return y.isNumber(this.innerHeight)?`${this.innerHeight}px`:this.innerHeight},computedSpanGap(){return y.isNumber(this.spanGap)?`${this.spanGap}px`:this.spanGap},computedSideGap(){return y.isNumber(this.sideGap)?`${this.sideGap}px`:this.sideGap},customBtnStyle(){return{padding:`0 ${this.computedSideGap}`}},useLeft(){return this.$slots.left},useRight(){return this.$slots.right}},methods:{getObserveEntries(){return new Promise(t=>{const e=new IntersectionObserver(i=>{e.disconnect(),t(i)},{root:this.$refs.swiperBody});this.$refs.swiperItems.forEach(i=>{e.observe(i)})})},getDomTranslateX(){return Number(this.$refs.swiperWrapper.style.transform.split("(")[1].split("px")[0])},setDomTranslateX(t){this.$refs.swiperWrapper.style.transform=`translateX(${t}px)`},initDoubleList(){const t=Math.floor(this.list.length/2);this.doubleList=[...this.list.slice(t),...this.list,...this.list.slice(0,t)],this.listDiv=this.list.length-t},initItemWidth(){const t=f.getCssUnit(this.computedInnerWidth),e=f.getCssUnit(this.computedSpanGap);if(t!==e)throw new Error("Please unite spanGap\u3001innerWidth css unit");const i=f.getCssValue(this.computedInnerWidth),n=f.getCssValue(this.computedSpanGap),s=(i-n*(this.visibleLength-1))/this.visibleLength;this.itemWidth=s+t},initItemWidthValue(){const t=this.$refs.swiperItems[0];this.itemWidthValue=f.getDomPropertyValue(t,"width"),this.itemFullWidthValue=this.itemWidthValue+f.getDomPropertyValue(t,"margin-right")},initTranslateX(){const t=this.getDomTranslateX()-this.itemFullWidthValue*this.listDiv;return this.setDomTranslateX(t),Math.abs(t)},play(){this.translateX=this.getDomTranslateX();const t=()=>{this.setMove(this.step),this.animationInterval=requestAnimationFrame(t)};this.animationInterval=requestAnimationFrame(t)},replay(){clearTimeout(this.replayTimer),this.replayTimer=setTimeout(()=>{this.playing||this.play()},this.playDelay)},setMove(t){this.translateX+=t;const e=Math.abs(this.translateX);e>=this.rightBorder?this.translateX=-(this.leftBorder+(e-this.rightBorder)):e<=this.leftBorder&&(this.translateX=-(this.rightBorder-(this.leftBorder-e))),this.setDomTranslateX(this.translateX)},_slidePrev(){this.getObserveEntries().then(t=>{const e=t.findLastIndex(a=>a.intersectionRatio>=this.intersectionRatioThreshold),n=t.filter(a=>a.intersectionRatio>=this.intersectionRatioThreshold).length===this.visibleLength?e-1:e,s=t[n],d=s.rootBounds.right-s.boundingClientRect.right;this.translateX+=d,this.setDomTranslateX(this.translateX);const h=Math.abs(this.translateX);setTimeout(()=>{h<=this.leftBorder&&(this.translateX=-(this.itemFullWidthValue*(n-this.visibleLength+1+this.list.length)),this.setDomTranslateX(this.translateX))},this.slideAnimationDuration)})},_slideNext(){this.getObserveEntries().then(t=>{const e=t.findIndex(a=>a.intersectionRatio>=this.intersectionRatioThreshold),n=t.filter(a=>a.intersectionRatio>=this.intersectionRatioThreshold).length===this.visibleLength?e+1:e,s=t[n],d=s.boundingClientRect.left-s.rootBounds.left;this.translateX-=d,this.setDomTranslateX(this.translateX);const h=Math.abs(this.translateX);setTimeout(()=>{h>=this.rightBorder&&(this.translateX=-(this.itemFullWidthValue*(n-this.list.length)),this.setDomTranslateX(this.translateX))},this.slideAnimationDuration)})},initOffset(){let t=0;if(y.isNumber(this.initialOffset))t=this.initialOffset;else if(f.getCssUnit(this.initialOffset)==="px")t=f.getCssValue(this.initialOffset);else{const i=document.createElement("div");i.setAttribute("style",`width: ${this.initialOffset}; position: fixed; top: 9999px`),document.body.appendChild(i),t=f.getDomPropertyValue(i,"width"),document.body.removeChild(i)}this.translateX=this.getDomTranslateX(),this.setMove(t)},slidePrev(){if(this.itemWidthMode!==T.COMPUTED)throw new Error("\u4EC5 computed-item-width \u6A21\u5F0F\u652F\u6301 slidePrev");this.handleSlide(!0)},slideNext(){if(this.itemWidthMode!==T.COMPUTED)throw new Error("\u4EC5 computed-item-width \u6A21\u5F0F\u652F\u6301 slideNext");this.handleSlide()},touchstart(t){this.playing=!0,cancelAnimationFrame(this.animationInterval);const e=t.targetTouches[0];this.lastX=e.pageX,this.translateX=this.getDomTranslateX()},touchmove(t){const e=t.targetTouches[0],i=e.pageX-this.lastX;this.lastX=e.pageX,this.setMove(i)},touchend(){this.playing=!1,this.autoPlay&&this.replay()},touchcancel(){this.touchend()}},created(){if(this.itemWidthMode===T.COMPUTED){if(!this.visibleLength)throw new Error("visibleLength \u5FC5\u987B\u4E3A\u5927\u4E8E 0 \u7684\u6574\u6570");this.initItemWidth()}this.initDoubleList()},mounted(){this.initItemWidthValue();const t=this.initTranslateX();if(this.leftBorder=t,this.rightBorder=this.itemFullWidthValue*this.list.length+t,this.initialOffset&&this.initOffset(),this.autoPlay){if(this.playImmediate){this.play();return}this.replay()}this.handleSlide=y.throttle(e=>{cancelAnimationFrame(this.animationInterval),Object.assign(this.$refs.swiperWrapper.style,{"transition-duration":`${this.slideAnimationDuration}ms`}),this.translateX=this.getDomTranslateX(),e?this._slidePrev():this._slideNext(),setTimeout(()=>{Object.assign(this.$refs.swiperWrapper.style,{"transition-duration":"0ms"}),this.autoPlay&&this.replay()},this.slideAnimationDuration)},this.slideAnimationDuration+200,{trailing:!1})},beforeDestroy(){clearTimeout(this.replayTimer),cancelAnimationFrame(this.animationInterval)}},x={};var it=tt(et,Q,Y,!1,st,"82881cae",null,null);function st(t){for(let e in x)this[e]=x[e]}var nt=function(){return it.exports}();return nt});
